<form class="input-container" [formGroup]="messageData" (ngSubmit)="onSubmit()">
  <textarea [placeholder]="'Nachricht an ' + this.chatService.placeholderName" formControlName="message"></textarea>
  <div class="button-container">
    <div class="left-section">
		<div class="add-data-container icon-container">
			<label for="fileUpload" class="button-white">
				<img class="pointer" src="assets/img/icons/add_grey.png" alt="icon-add" />
				<input type="file" id="fileUpload" (change)="uploadFile($event)" />
			</label>
		</div>
      <img class="" src="assets/img/icons/vertical_line_grey.png" alt="icon-vertical-line" />
      <div class="icon-container pointer" (click)="toggleEmojiPicker()">
        <img src="assets/img/icons/smiley_grey.png" alt="icon-smiley" />
      </div>
      <div class="icon-container pointer" (click)="toggleTagUser()">
        <img src="assets/img/icons/alternate_email_grey.png" alt="icon-email" />
      </div>
    </div>
    <div class="right-section">
      <button class="pointer" type="submit">
        <img src="assets/img/icons/send_dark_blue.png" alt="icon-send" />
      </button>
    </div>
  </div>
</form>

<!-- emoji Picker-->
@if (showEmojiPicker) {
<div class="emoji-picker-container">
  <emoji-mart (emojiClick)="addEmoji($event)"></emoji-mart>
</div>
}

<!--tag a channel Member-->
@if (showTagContainer && this.chatService.mainCollection == 'channels') {
<div class="tag-container">
  <div class="member-selection-wrapper">
    <div class="top-section">
      <div class="pointer close-btn" (click)="toggleTagUser()">
        <img src="../../../../assets/img/icons/close_black.png" alt="close-icon" />
      </div>
    </div>
    @for (channel of this.firebaseService.channelList; track channel; let index = $index) {
    @for (user of channel.members; track user; let index = $index) {
    @if (user !== this.firebaseService.currentUserId && channel.chanId === this.chatService.docRef) {
    <div class="member-container pointer" (click)="tagUser(this.firebaseService.getUserDisplayName(user), user)">
      <div class="user-avatar">
        <img [src]="this.firebaseService.getUserAvatar(user)" alt="User Avatar" />
        <div class="user-status"
          [ngClass]="{ 'online': this.firebaseService.getUserOnlineStatus(user), 'offline': !this.firebaseService.getUserOnlineStatus(user) }">
        </div>
      </div>
      <span>{{ this.firebaseService.getUserDisplayName(user) }}</span>
    </div>
    }
    }
    }
  </div>
</div>
}


<!--tag a user-->
@if (this.communicationService.showAllUsers && showTagContainer) {
<div class="tag-container">
  <div class="member-selection-wrapper">
    <div class="top-section">
      <div class="pointer close-btn" (click)="toggleTagUser()">
        <img src="../../../../assets/img/icons/close_black.png" alt="close-icon" />
      </div>
    </div>
    @for (user of this.firebaseService.userList; track user; let index = $index) {
    @if (user !== this.firebaseService.currentUserId) {
    <div class="member-container pointer" (click)="tagUser(user.name, user.userId)">
      <div class="user-avatar">
        <img [src]="this.firebaseService.getUserAvatar(user.userId)" alt="User Avatar" />
        <div class="user-status"
          [ngClass]="{ 'online': this.firebaseService.getUserOnlineStatus(user.userId), 'offline': !this.firebaseService.getUserOnlineStatus(user.userId) }">
        </div>
      </div>
      <span>{{ this.firebaseService.getUserDisplayName(user.userId) }}</span>
    </div>
    }
    }
  </div>
</div>
}

<!--tag a chat participant-->
@if (showTagContainer && this.chatService.mainCollection == 'privateChats') {
<div class="tag-container">
  <div class="member-selection-wrapper">
    <div class="top-section">
      <div class="pointer close-btn" (click)="toggleTagUser()">
        <img src="../../../../assets/img/icons/close_black.png" alt="close-icon" />
      </div>
    </div>
    @for (privateChat of this.firebaseService.privateChatList; track privateChat; let index = $index) {
    @if (privateChat.privatChatId === this.chatService.docRef) {
    @if (privateChat.chatReciver == this.firebaseService.currentUserId) {
    <div class="member-container pointer"
      (click)="tagUser(this.firebaseService.getUserDisplayName(privateChat.chatCreator), privateChat.chatCreator)">
      <div class="user-avatar">
        <img [src]="this.firebaseService.getUserAvatar(privateChat.chatCreator)" alt="User Avatar" />
        <div class="user-status"
          [ngClass]="{ 'online': this.firebaseService.getUserOnlineStatus(privateChat.chatCreator), 'offline': !this.firebaseService.getUserOnlineStatus(privateChat.chatCreator) }">
        </div>
      </div>
      <span>{{ this.firebaseService.getUserDisplayName(privateChat.chatCreator) }}</span>
    </div>
    } @if (privateChat.chatReciver !== this.firebaseService.currentUserId) {
    <div class="member-container pointer"
      (click)="tagUser(this.firebaseService.getUserDisplayName(privateChat.chatCreator), privateChat.chatCreator)">
      <div class="user-avatar">
        <img [src]="this.firebaseService.getUserAvatar(privateChat.chatCreator)" alt="User Avatar" />
        <div class="user-status"
          [ngClass]="{ 'online': this.firebaseService.getUserOnlineStatus(privateChat.chatCreator), 'offline': !this.firebaseService.getUserOnlineStatus(privateChat.chatCreator) }">
        </div>
      </div>
      <span>{{ this.firebaseService.getUserDisplayName(privateChat.chatCreator) }}</span>
    </div>
    }
    }
    }
  </div>
</div>
}