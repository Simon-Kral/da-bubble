<div class="new-message-wrapper">

  <div class="new-message-top">
    <h1>Neue Nachricht</h1>
    <form class="searchbar-container" [formGroup]="searchText">
      <input class="searchbar" type="text" placeholder="An: #channel oder @jemanden oder E-Mail Adresse"
        formControlName="search" (input)="this.handleSearch()" />

      <!--selected Reciver-->
      <div class="show-selected-users">
        @for (user of this.searchService.selectedUser; track user; let index = $index) {
          <div class="pointer added-data" (click)="removeSelectedUser(user)">
            <img [src]="this.firebaseService.getUserAvatar(user)" alt="profile-pic" />
            <span>{{ this.firebaseService.getUserDisplayName(user) }}</span>
            <div class="remove-user">
              <img src="assets/img/icons/close_black.png" alt="close-icon" />
            </div>
          </div>
        }
      </div>

      <!--selected Channel-->
      @if (this.searchService.selectedChannel) {
        <div class="show-selected-channel">
            <div class="pointer added-data" (click)="removeSelectedChannel()">
              <span>{{ this.chatService.getChannelNameById(this.searchService.selectedChannel) }}</span>
              <div class="remove">
                <img src="assets/img/icons/close_black.png" alt="close-icon" />
              </div>
            </div>
        </div>
      }


    </form>

    <!--user search results-->
    @if (showUsers) {
      <div class="search-results">
        @for (user of this.firebaseService.userList; track user; let index = $index) {
          <div class="content-container pointer" (click)="handleClickOnMember(user.userId)">
              <span>{{ '@' + this.firebaseService.getUserDisplayName(user.userId) }}</span>
        </div>
        }
      </div>
      }


      <!--channel search results-->
      @if (showChannels) {
      <div class="search-results">
        @for (channel of this.firebaseService.channelList; track channel; let index = $index) {
          <div class="content-container pointer" (click)="handleClickOnChannel(channel.chanId)">
              <span>{{ '#' + channel.name }}</span>
        </div>
        }
      </div>  
    }
    </div>



  <div class="chat-input">
    <app-chat-input [sourceComponent]="'newMessage'" [placeholderText]="'Starte eine neue Nachricht'" (messageEvent)="this.chatService.onMessageSent($event)"></app-chat-input>
  </div>

</div>